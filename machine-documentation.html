<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dokumentacja Maszyn - DAREMON</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        body {
            max-width: 960px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        main {
            display: grid;
            gap: 2rem;
        }
        .intro-banner {
            background: rgba(4, 19, 43, 0.7);
            border: 1px solid rgba(255, 149, 0, 0.45);
            padding: 1.5rem;
            border-radius: 18px;
            text-align: center;
            box-shadow: 0 22px 45px rgba(0, 0, 0, 0.35);
        }
        .intro-banner h1 {
            margin-bottom: 0.5rem;
        }
        .support-note {
            font-size: 0.9rem;
            opacity: 0.75;
            margin-top: 0.5rem;
        }
        .resource-grid {
            display: grid;
            gap: 1.5rem;
        }
        @media (min-width: 768px) {
            .resource-grid {
                grid-template-columns: repeat(2, minmax(0, 1fr));
            }
        }
        .resource-card {
            background: rgba(6, 25, 56, 0.6);
            border: 1px solid rgba(24, 160, 199, 0.2);
            border-radius: 16px;
            padding: 1.25rem;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        .checklist {
            padding-left: 1.2rem;
            display: grid;
            gap: 0.4rem;
        }
        .grid-span-2 {
            grid-column: span 2;
        }
        .whatsapp-banner {
            background: linear-gradient(135deg, rgba(24, 160, 199, 0.85), rgba(9, 110, 186, 0.8));
            color: #04132b;
            border-radius: 18px;
            padding: 1rem 1.5rem;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            font-weight: 600;
        }
        .photo-tips {
            background: rgba(4, 19, 43, 0.75);
            border-radius: 14px;
            padding: 1rem 1.25rem;
            display: grid;
            gap: 0.5rem;
        }
        .photo-tips ul {
            margin: 0;
            padding-left: 1.1rem;
            display: grid;
            gap: 0.3rem;
        }
        footer {
            margin-top: 3rem;
            font-size: 0.85rem;
            opacity: 0.7;
            text-align: center;
        }
    </style>
</head>
<body data-theme="arburg">
    <main>
        <section class="intro-banner" aria-labelledby="doc-title">
            <h1 id="doc-title">A NIE MÓWIŁEM?! Zabezpieczamy maszyny dla Daremon</h1>
            <p>Dowody to nasza tarcza. Każde zdjęcie i każda linijka danych zbliża nas do GO/NO-GO z faktami na stole.</p>
            <p class="support-note">Ta strona zapisuje dane tylko lokalnie w Twojej przeglądarce. Udostępnij zdjęcia w grupie WhatsApp lub przeklej do arkusza Google.</p>
        </section>

        <section aria-labelledby="why-now" class="resource-card">
            <h2 id="why-now">Po co to robimy?</h2>
            <ul class="checklist">
                <li><strong>Negocjacje</strong> — dokumentacja pokazuje realną wartość przy rozmowach z Rompą i Hansem.</li>
                <li><strong>Backup</strong> — gdyby sprzęt zniknął, mamy dowód stanu i kompletności.</li>
                <li><strong>Planowanie</strong> — wiemy, które maszyny są krytyczne dla startu Daremon.</li>
            </ul>
        </section>

        <section class="resource-card" aria-labelledby="action-steps">
            <h2 id="action-steps">3 kroki — szybciej niż kawa</h2>
            <ol class="checklist" aria-label="Instrukcja dokumentacji">
                <li><strong>Sfotografuj</strong> tabliczkę znamionową, licznik godzin, całą maszynę.</li>
                <li><strong>Zapisz</strong> nazwę, model, numer seryjny, lokalizację i stan.</li>
                <li><strong>Wyślij</strong> przez formularz i wrzuć zdjęcia do grupy WhatsApp lub arkusza.</li>
            </ol>
        </section>

        <section class="resource-card grid-span-2" aria-labelledby="live-tracker">
            <h2 id="live-tracker">Live tracker — tylko dla Ciebie</h2>
            <div class="machine-live-stats" aria-live="polite">
                <div class="machine-stat-card">
                    <span class="machine-stat-value" id="full-machine-count">0</span>
                    <span class="machine-stat-label">Udokumentowane maszyny</span>
                </div>
                <div class="machine-stat-card">
                    <span class="machine-stat-value" id="full-team-count">0</span>
                    <span class="machine-stat-label">Osoby w akcji</span>
                </div>
                <div class="machine-stat-card">
                    <span class="machine-stat-value" id="full-estimated-value">€0</span>
                    <span class="machine-stat-label">Szacowana wartość</span>
                </div>
            </div>
            <div class="machine-register">
                <table aria-label="Lista zarejestrowanych maszyn">
                    <thead>
                        <tr>
                            <th scope="col">Nazwa</th>
                            <th scope="col">Model</th>
                            <th scope="col">Numer seryjny</th>
                            <th scope="col">Lokalizacja</th>
                            <th scope="col">Stan</th>
                        </tr>
                    </thead>
                    <tbody id="full-machine-table"></tbody>
                </table>
            </div>
        </section>

        <section class="resource-card grid-span-2" aria-labelledby="doc-form-title">
            <h2 id="doc-form-title">Formularz dokumentacji</h2>
            <form id="machine-doc-full-form" class="machine-doc-form" aria-describedby="full-form-helper">
                <div class="form-row">
                    <label for="full-machine-name">Nazwa maszyny *</label>
                    <input id="full-machine-name" name="machineName" required autocomplete="off">
                </div>
                <div class="form-row">
                    <label for="full-machine-model">Model</label>
                    <input id="full-machine-model" name="machineModel" autocomplete="off">
                </div>
                <div class="form-row">
                    <label for="full-machine-serial">Numer seryjny</label>
                    <input id="full-machine-serial" name="machineSerial" autocomplete="off">
                </div>
                <div class="form-row">
                    <label for="full-machine-location">Lokalizacja</label>
                    <input id="full-machine-location" name="machineLocation" placeholder="Hala, linia, sektor">
                </div>
                <div class="form-row">
                    <label for="full-machine-condition">Stan / uwagi</label>
                    <textarea id="full-machine-condition" name="machineCondition" rows="3"></textarea>
                </div>
                <div class="form-row">
                    <label for="full-machine-reporter">Twoje imię (opcjonalnie)</label>
                    <input id="full-machine-reporter" name="machineReporter" autocomplete="name">
                </div>
                <div class="form-row">
                    <label for="full-photo-count">Liczba zdjęć</label>
                    <input id="full-photo-count" name="photoCount" type="number" min="0" step="1" value="0">
                </div>
                <p id="full-form-helper" class="form-helper">Dane trafiają do localStorage Twojej przeglądarki pod kluczem <code>daremon_machine_docs_v1</code>. Następnie wyślij zdjęcia w grupie WhatsApp lub przez arkusz Google.</p>
                <button type="submit" class="cta-button primary">Zapisz lokalnie</button>
                <p id="full-form-status" class="form-feedback" aria-live="assertive"></p>
            </form>
        </section>

        <section class="resource-card" aria-labelledby="whatsapp-group">
            <h2 id="whatsapp-group">Grupa WhatsApp Komisji Maszyn</h2>
            <div class="whatsapp-banner">
                <span>💬 Szybkie aktualizacje, pytania, ustalenia w czasie rzeczywistym.</span>
                <button type="button" id="full-whatsapp-button" class="cta-button secondary" aria-label="Otwórz grupę WhatsApp">Dołącz teraz</button>
            </div>
        </section>

        <section class="resource-card" aria-labelledby="photo-tips-title">
            <h2 id="photo-tips-title">Jak zrobić zdjęcia, które wygrywają negocjacje?</h2>
            <div class="photo-tips">
                <ul>
                    <li>Ustaw telefon poziomo, by zmieścić całą maszynę.</li>
                    <li>Zrób zbliżenie tabliczki znamionowej (czytelne wartości).</li>
                    <li>Uchwyć licznik godzin i ewentualne uszkodzenia.</li>
                    <li>Dodaj zdjęcie otoczenia (gdzie stoi maszyna).</li>
                    <li>Jeśli widać akcesoria lub formy — również je sfotografuj.</li>
                </ul>
            </div>
        </section>
    </main>

    <footer>
        Przygotował zespół Daremon. Dane zostają u Ciebie — udostępniaj je świadomie.
    </footer>

    <script>
        const MACHINE_DOCS_KEY = 'daremon_machine_docs_v1';
        const WHATSAPP_GROUP_LINK = 'https://chat.whatsapp.com/TO-BE-SET';

        const loadDocs = () => {
            try {
                const raw = localStorage.getItem(MACHINE_DOCS_KEY);
                if (!raw) return [];
                const parsed = JSON.parse(raw);
                return Array.isArray(parsed) ? parsed : [];
            } catch (error) {
                console.error('Nie udało się odczytać dokumentacji maszyn:', error);
                return [];
            }
        };

        const saveDocs = (entries) => {
            try {
                localStorage.setItem(MACHINE_DOCS_KEY, JSON.stringify(entries));
            } catch (error) {
                console.error('Nie udało się zapisać dokumentacji maszyn:', error);
            }
        };

        const euroFormatter = new Intl.NumberFormat('pl-PL', {
            style: 'currency',
            currency: 'EUR',
            minimumFractionDigits: 0,
        });

        function renderDocs() {
            const entries = loadDocs();
            const tableBody = document.getElementById('full-machine-table');
            const machinesEl = document.getElementById('full-machine-count');
            const teamEl = document.getElementById('full-team-count');
            const valueEl = document.getElementById('full-estimated-value');

            if (machinesEl) {
                machinesEl.textContent = String(entries.length);
            }

            if (teamEl) {
                const reporters = new Set(entries.filter(item => item.reporter).map(item => item.reporter.trim().toLowerCase()));
                teamEl.textContent = String(reporters.size);
            }

            if (valueEl) {
                const estimated = Math.max(0, entries.length * 2500);
                valueEl.textContent = euroFormatter.format(estimated);
            }

            if (!tableBody) return;
            tableBody.innerHTML = '';

            if (!entries.length) {
                const row = document.createElement('tr');
                const cell = document.createElement('td');
                cell.colSpan = 5;
                cell.textContent = 'Brak zgłoszeń — czas złapać aparat.';
                row.appendChild(cell);
                tableBody.appendChild(row);
                return;
            }

            entries.slice(0, 30).forEach(entry => {
                const row = document.createElement('tr');
                const cells = [
                    entry.machineName || '—',
                    entry.machineModel || '—',
                    entry.machineSerial || '—',
                    entry.machineLocation || '—',
                    entry.machineCondition || 'Brak danych',
                ];
                cells.forEach(value => {
                    const cell = document.createElement('td');
                    cell.textContent = value;
                    row.appendChild(cell);
                });
                tableBody.appendChild(row);
            });
        }

        function handleSubmit(event) {
            event.preventDefault();
            const form = event.currentTarget;
            const status = document.getElementById('full-form-status');
            const formData = new FormData(form);
            const entry = {
                machineName: formData.get('machineName')?.trim() || '',
                machineModel: formData.get('machineModel')?.trim() || '',
                machineSerial: formData.get('machineSerial')?.trim() || '',
                machineLocation: formData.get('machineLocation')?.trim() || '',
                machineCondition: formData.get('machineCondition')?.trim() || '',
                reporter: formData.get('machineReporter')?.trim() || '',
                photoCount: Number.parseInt(formData.get('photoCount'), 10) || 0,
                createdAt: new Date().toISOString(),
            };

            const entries = loadDocs();
            entries.unshift(entry);
            saveDocs(entries.slice(0, 40));
            renderDocs();
            form.reset();

            if (status) {
                status.textContent = 'Zapisano lokalnie. Podeślij zdjęcia na grupie WhatsApp!';
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            renderDocs();
            const form = document.getElementById('machine-doc-full-form');
            if (form) {
                form.addEventListener('submit', handleSubmit);
            }
            const button = document.getElementById('full-whatsapp-button');
            if (button) {
                button.addEventListener('click', () => window.open(WHATSAPP_GROUP_LINK, '_blank', 'noopener'));
            }
        });
    </script>
</body>
</html>
